using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.Serialization.Formatters.Binary;
using System.Runtime.Serialization.Formatters;
using System.IO;

namespace Computer
{
    public abstract class CIMController : CIMLogicalDevice
    {
        private UInt32 maxNumberControlled;
        private UInt16 protocolSupported;
        private DateTime timeOfLastReset;

        private string cim_TimeOfLastReset;


        private Dictionary<ushort, string> dictionProtocolSupported;


        private byte[] arr ={
            0,1,0,0,0,255,255,255,255,1,
            0,0,0,0,0,0,0,4,1,0,0,
            0,226,1,83,121,115,116,101,109,46,67,
            111,108,108,101,99,116,105,111,110,115,46,
            71,101,110,101,114,105,99,46,68,105,99,
            116,105,111,110,97,114,121,96,50,91,91,
            83,121,115,116,101,109,46,85,73,110,116,
            49,54,44,32,109,115,99,111,114,108,105,
            98,44,32,86,101,114,115,105,111,110,61,
            50,46,48,46,48,46,48,44,32,67,117,
            108,116,117,114,101,61,110,101,117,116,114,
            97,108,44,32,80,117,98,108,105,99,75,
            101,121,84,111,107,101,110,61,98,55,55,
            97,53,99,53,54,49,57,51,52,101,48,
            56,57,93,44,91,83,121,115,116,101,109,
            46,83,116,114,105,110,103,44,32,109,115,
            99,111,114,108,105,98,44,32,86,101,114,
            115,105,111,110,61,50,46,48,46,48,46,
            48,44,32,67,117,108,116,117,114,101,61,
            110,101,117,116,114,97,108,44,32,80,117,
            98,108,105,99,75,101,121,84,111,107,101,
            110,61,98,55,55,97,53,99,53,54,49,
            57,51,52,101,48,56,57,93,93,4,0,
            0,0,7,86,101,114,115,105,111,110,8,
            67,111,109,112,97,114,101,114,8,72,97,
            115,104,83,105,122,101,13,75,101,121,86,
            97,108,117,101,80,97,105,114,115,0,3,
            0,3,8,146,1,83,121,115,116,101,109,
            46,67,111,108,108,101,99,116,105,111,110,
            115,46,71,101,110,101,114,105,99,46,71,
            101,110,101,114,105,99,69,113,117,97,108,
            105,116,121,67,111,109,112,97,114,101,114,
            96,49,91,91,83,121,115,116,101,109,46,
            85,73,110,116,49,54,44,32,109,115,99,
            111,114,108,105,98,44,32,86,101,114,115,
            105,111,110,61,50,46,48,46,48,46,48,
            44,32,67,117,108,116,117,114,101,61,110,
            101,117,116,114,97,108,44,32,80,117,98,
            108,105,99,75,101,121,84,111,107,101,110,
            61,98,55,55,97,53,99,53,54,49,57,
            51,52,101,48,56,57,93,93,8,230,1,
            83,121,115,116,101,109,46,67,111,108,108,
            101,99,116,105,111,110,115,46,71,101,110,
            101,114,105,99,46,75,101,121,86,97,108,
            117,101,80,97,105,114,96,50,91,91,83,
            121,115,116,101,109,46,85,73,110,116,49,
            54,44,32,109,115,99,111,114,108,105,98,
            44,32,86,101,114,115,105,111,110,61,50,
            46,48,46,48,46,48,44,32,67,117,108,
            116,117,114,101,61,110,101,117,116,114,97,
            108,44,32,80,117,98,108,105,99,75,101,
            121,84,111,107,101,110,61,98,55,55,97,
            53,99,53,54,49,57,51,52,101,48,56,
            57,93,44,91,83,121,115,116,101,109,46,
            83,116,114,105,110,103,44,32,109,115,99,
            111,114,108,105,98,44,32,86,101,114,115,
            105,111,110,61,50,46,48,46,48,46,48,
            44,32,67,117,108,116,117,114,101,61,110,
            101,117,116,114,97,108,44,32,80,117,98,
            108,105,99,75,101,121,84,111,107,101,110,
            61,98,55,55,97,53,99,53,54,49,57,
            51,52,101,48,56,57,93,93,91,93,48,
            0,0,0,9,2,0,0,0,89,0,0,
            0,9,3,0,0,0,4,2,0,0,0,
            146,1,83,121,115,116,101,109,46,67,111,
            108,108,101,99,116,105,111,110,115,46,71,
            101,110,101,114,105,99,46,71,101,110,101,
            114,105,99,69,113,117,97,108,105,116,121,
            67,111,109,112,97,114,101,114,96,49,91,
            91,83,121,115,116,101,109,46,85,73,110,
            116,49,54,44,32,109,115,99,111,114,108,
            105,98,44,32,86,101,114,115,105,111,110,
            61,50,46,48,46,48,46,48,44,32,67,
            117,108,116,117,114,101,61,110,101,117,116,
            114,97,108,44,32,80,117,98,108,105,99,
            75,101,121,84,111,107,101,110,61,98,55,
            55,97,53,99,53,54,49,57,51,52,101,
            48,56,57,93,93,0,0,0,0,7,3,
            0,0,0,0,1,0,0,0,48,0,0,
            0,3,228,1,83,121,115,116,101,109,46,
            67,111,108,108,101,99,116,105,111,110,115,
            46,71,101,110,101,114,105,99,46,75,101,
            121,86,97,108,117,101,80,97,105,114,96,
            50,91,91,83,121,115,116,101,109,46,85,
            73,110,116,49,54,44,32,109,115,99,111,
            114,108,105,98,44,32,86,101,114,115,105,
            111,110,61,50,46,48,46,48,46,48,44,
            32,67,117,108,116,117,114,101,61,110,101,
            117,116,114,97,108,44,32,80,117,98,108,
            105,99,75,101,121,84,111,107,101,110,61,
            98,55,55,97,53,99,53,54,49,57,51,
            52,101,48,56,57,93,44,91,83,121,115,
            116,101,109,46,83,116,114,105,110,103,44,
            32,109,115,99,111,114,108,105,98,44,32,
            86,101,114,115,105,111,110,61,50,46,48,
            46,48,46,48,44,32,67,117,108,116,117,
            114,101,61,110,101,117,116,114,97,108,44,
            32,80,117,98,108,105,99,75,101,121,84,
            111,107,101,110,61,98,55,55,97,53,99,
            53,54,49,57,51,52,101,48,56,57,93,
            93,4,252,255,255,255,228,1,83,121,115,
            116,101,109,46,67,111,108,108,101,99,116,
            105,111,110,115,46,71,101,110,101,114,105,
            99,46,75,101,121,86,97,108,117,101,80,
            97,105,114,96,50,91,91,83,121,115,116,
            101,109,46,85,73,110,116,49,54,44,32,
            109,115,99,111,114,108,105,98,44,32,86,
            101,114,115,105,111,110,61,50,46,48,46,
            48,46,48,44,32,67,117,108,116,117,114,
            101,61,110,101,117,116,114,97,108,44,32,
            80,117,98,108,105,99,75,101,121,84,111,
            107,101,110,61,98,55,55,97,53,99,53,
            54,49,57,51,52,101,48,56,57,93,44,
            91,83,121,115,116,101,109,46,83,116,114,
            105,110,103,44,32,109,115,99,111,114,108,
            105,98,44,32,86,101,114,115,105,111,110,
            61,50,46,48,46,48,46,48,44,32,67,
            117,108,116,117,114,101,61,110,101,117,116,
            114,97,108,44,32,80,117,98,108,105,99,
            75,101,121,84,111,107,101,110,61,98,55,
            55,97,53,99,53,54,49,57,51,52,101,
            48,56,57,93,93,2,0,0,0,3,107,
            101,121,5,118,97,108,117,101,0,1,14,
            0,0,6,5,0,0,0,0,1,250,255,
            255,255,252,255,255,255,1,0,6,7,0,
            0,0,5,79,116,104,101,114,1,248,255,
            255,255,252,255,255,255,2,0,6,9,0,
            0,0,7,85,110,107,110,111,119,110,1,
            246,255,255,255,252,255,255,255,3,0,6,
            11,0,0,0,4,69,73,83,65,1,244,
            255,255,255,252,255,255,255,4,0,6,13,
            0,0,0,3,73,83,65,1,242,255,255,
            255,252,255,255,255,5,0,6,15,0,0,
            0,3,80,67,73,1,240,255,255,255,252,
            255,255,255,6,0,6,17,0,0,0,9,
            65,84,65,47,65,84,65,80,73,1,238,
            255,255,255,252,255,255,255,7,0,6,19,
            0,0,0,17,70,108,101,120,105,98,108,
            101,32,68,105,115,107,101,116,116,101,1,
            236,255,255,255,252,255,255,255,8,0,6,
            21,0,0,0,4,49,52,57,54,1,234,
            255,255,255,252,255,255,255,9,0,6,23,
            0,0,0,23,83,67,83,73,32,80,97,
            114,97,108,108,101,108,32,73,110,116,101,
            114,102,97,99,101,1,232,255,255,255,252,
            255,255,255,10,0,6,25,0,0,0,27,
            83,67,83,73,32,70,105,98,114,101,32,
            67,104,97,110,110,101,108,32,80,114,111,
            116,111,99,111,108,1,230,255,255,255,252,
            255,255,255,11,0,6,27,0,0,0,24,
            83,67,83,73,32,83,101,114,105,97,108,
            32,66,117,115,32,80,114,111,116,111,99,
            111,108,1,228,255,255,255,252,255,255,255,
            12,0,6,29,0,0,0,33,83,67,83,
            73,32,83,101,114,105,97,108,32,66,117,
            115,32,80,114,111,116,111,99,111,108,45,
            50,32,40,49,51,57,52,41,1,226,255,
            255,255,252,255,255,255,13,0,6,31,0,
            0,0,32,83,67,83,73,32,83,101,114,
            105,97,108,32,83,116,111,114,97,103,101,
            32,65,114,99,104,105,116,101,99,116,117,
            114,101,1,224,255,255,255,252,255,255,255,
            14,0,6,33,0,0,0,4,86,69,83,
            65,1,222,255,255,255,252,255,255,255,15,
            0,6,35,0,0,0,6,80,67,77,67,
            73,65,1,220,255,255,255,252,255,255,255,
            16,0,6,37,0,0,0,20,85,110,105,
            118,101,114,115,97,108,32,83,101,114,105,
            97,108,32,66,117,115,1,218,255,255,255,
            252,255,255,255,17,0,6,39,0,0,0,
            17,80,97,114,97,108,108,101,108,32,80,
            114,111,116,111,99,111,108,1,216,255,255,
            255,252,255,255,255,18,0,6,41,0,0,
            0,5,69,83,67,79,78,1,214,255,255,
            255,252,255,255,255,19,0,6,43,0,0,
            0,10,68,105,97,103,110,111,115,116,105,
            99,1,212,255,255,255,252,255,255,255,20,
            0,6,45,0,0,0,3,73,50,67,1,
            210,255,255,255,252,255,255,255,21,0,6,
            47,0,0,0,5,80,111,119,101,114,1,
            208,255,255,255,252,255,255,255,22,0,6,
            49,0,0,0,5,72,73,80,80,73,1,
            206,255,255,255,252,255,255,255,23,0,6,
            51,0,0,0,8,77,117,108,116,105,66,
            117,115,1,204,255,255,255,252,255,255,255,
            24,0,6,53,0,0,0,3,86,77,69,
            1,202,255,255,255,252,255,255,255,25,0,
            6,55,0,0,0,3,73,80,73,1,200,
            255,255,255,252,255,255,255,26,0,6,57,
            0,0,0,8,73,69,69,69,45,52,56,
            56,1,198,255,255,255,252,255,255,255,27,
            0,6,59,0,0,0,5,82,83,50,51,
            50,1,196,255,255,255,252,255,255,255,28,
            0,6,61,0,0,0,18,73,69,69,69,
            32,56,48,50,46,51,32,49,48,66,65,
            83,69,53,1,194,255,255,255,252,255,255,
            255,29,0,6,63,0,0,0,18,73,69,
            69,69,32,56,48,50,46,51,32,49,48,
            66,65,83,69,50,1,192,255,255,255,252,
            255,255,255,30,0,6,65,0,0,0,17,
            73,69,69,69,32,56,48,50,46,51,32,
            49,66,65,83,69,53,1,190,255,255,255,
            252,255,255,255,31,0,6,67,0,0,0,
            20,73,69,69,69,32,56,48,50,46,51,
            32,49,48,66,82,79,65,68,51,54,1,
            188,255,255,255,252,255,255,255,32,0,6,
            69,0,0,0,20,73,69,69,69,32,56,
            48,50,46,51,32,49,48,48,66,65,83,
            69,86,71,1,186,255,255,255,252,255,255,
            255,33,0,6,71,0,0,0,21,73,69,
            69,69,32,56,48,50,46,53,32,84,111,
            107,101,110,45,82,105,110,103,1,184,255,
            255,255,252,255,255,255,34,0,6,73,0,
            0,0,16,65,78,83,73,32,88,51,84,
            57,46,53,32,70,68,68,73,1,182,255,
            255,255,252,255,255,255,35,0,6,75,0,
            0,0,3,77,67,65,1,180,255,255,255,
            252,255,255,255,36,0,6,77,0,0,0,
            4,69,83,68,73,1,178,255,255,255,252,
            255,255,255,37,0,6,79,0,0,0,3,
            73,68,69,1,176,255,255,255,252,255,255,
            255,38,0,6,81,0,0,0,3,67,77,
            68,1,174,255,255,255,252,255,255,255,39,
            0,6,83,0,0,0,5,83,84,53,48,
            54,1,172,255,255,255,252,255,255,255,40,
            0,6,85,0,0,0,4,68,83,83,73,
            1,170,255,255,255,252,255,255,255,41,0,
            6,87,0,0,0,4,81,73,67,50,1,
            168,255,255,255,252,255,255,255,42,0,6,
            89,0,0,0,16,69,110,104,97,110,99,
            101,100,32,65,84,65,47,73,68,69,1,
            166,255,255,255,252,255,255,255,43,0,6,
            91,0,0,0,3,65,71,80,1,164,255,
            255,255,252,255,255,255,44,0,6,93,0,
            0,0,24,84,87,73,82,80,32,40,116,
            119,111,45,119,97,121,32,105,110,102,114,
            97,114,101,100,41,1,162,255,255,255,252,
            255,255,255,45,0,6,95,0,0,0,19,
            70,73,82,32,40,102,97,115,116,32,105,
            110,102,114,97,114,101,100,41,1,160,255,
            255,255,252,255,255,255,46,0,6,97,0,
            0,0,21,83,73,82,32,40,115,101,114,
            105,97,108,32,105,110,102,114,97,114,101,
            100,41,1,158,255,255,255,252,255,255,255,
            47,0,6,99,0,0,0,5,73,114,66,
            117,115,11,0
        };



        /// <summary>
        ///通过管理员管理的最大直接地址的号码
        /// </summary>        
        public UInt32 MaxNumberControlled
        {
            get { return maxNumberControlled; }
            set { maxNumberControlled = value; }
        }
        /// <summary>
        ///通过管理员访问受约束驱动的协议
        /// </summary>        
        public UInt16 ProtocolSupported
        {
            get { return protocolSupported; }
            set { protocolSupported = value; }
        }
        /// <summary>
        /// 管理员最后安排日期时间(按下Power后)
        /// </summary>        
        public DateTime TimeOfLastReset
        {
            get 
            {
                timeOfLastReset = DmtfConverter.ToDateTime(cim_TimeOfLastReset);
                return timeOfLastReset; 
            }
        }
        public string Cim_TimeOfLastReset
        {
            get
            {
                return cim_TimeOfLastReset;
            }
            set
            {
                cim_TimeOfLastReset = value;
            }
        }
        /// <summary>
        /// 得到ProtocolSupported的意思通过key
        /// </summary>
        /// <param name="key">key</param>
        /// <returns>解释</returns>
        public string GetProtocolSupportedbyInt(ushort key)
        {
            string dic;
            bool a = YxDictionProtocolSupported.TryGetValue(key, out dic);
            if (a)
            {
                return dic;
            }
            else
            {
                throw new Exception("没有找到这个键的值");
            }
        }

        private void GetParser()
        {
            MemoryStream stream1 = new MemoryStream(this.arr);
            BinaryFormatter formatter1 = new BinaryFormatter();
            //			formatter1.set_AssemblyFormat(0);
            formatter1.AssemblyFormat = FormatterAssemblyStyle.Simple;
            dictionProtocolSupported = (Dictionary<ushort, string>)formatter1.Deserialize(stream1);
        }
        public Dictionary<ushort, string> YxDictionProtocolSupported
        {
            get
            {
                GetParser();
                return dictionProtocolSupported;
            }
        }

    }
}
